import{addLike,deleteLike}from"./api.js";import{openPopup}from"./popup.js";var cardTemplate=document.querySelector("#card-template").content;function createCard(r,t,c){var e,i,n,a,o,d;if(cardTemplate)return i=(e=cardTemplate.querySelector(".card").cloneNode(!0)).querySelector(".card__image"),n=e.querySelector(".card__title"),a=e.querySelector(".card__like-button"),o=e.querySelector(".card__delete-button"),e.setAttribute("data-card-uid",r._id),d=r.likes.length<1?0:r.likes.length,a.setAttribute("data-counter",d),d<1&&a.classList.add("card__like-button--no-counter"),i.src=r.link,n.textContent=r.name,void 0!==t&&(r.likes.find(function(e){return t._id===e._id})&&a.classList.add("card__like-button_is-active"),!1==(r.owner._id===t._id)?o.remove():o.addEventListener("click",function(e){e.currentTarget&&(window.localStorage.setItem("deleted_card","".concat(r._id)),openPopup(c))})),a.addEventListener("click",function(e){var t=e.currentTarget;t&&(t.classList.contains("card__like-button_is-active")?deleteLike(r._id).then(function(e){e.likes.length<1&&t.classList.add("card__like-button--no-counter"),a.setAttribute("data-counter",e.likes.length),t.classList.remove("card__like-button_is-active")}).catch(function(e){console.error("Ошибка при удалении лайка: ",e)}):addLike(r._id).then(function(e){0<e.likes.length&&a.classList.contains("card__like-button--no-counter")&&a.classList.remove("card__like-button--no-counter"),a.setAttribute("data-counter",e.likes.length),t.classList.add("card__like-button_is-active")}).catch(function(e){console.error("Ошибка при добавлении лайка: ",e)}))}),e}export{createCard};